(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["edit"],{1071:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("h3",[e._v(e._s(e.item.classe.name))]),e._l(e.item.classe.fields,(function(e){return a("b-input",{key:e.predicate,ref:e.predicate,refInFor:!0,attrs:{name:e.predicate,placeholder:e.label}})})),a("b-button",{on:{click:e.add}},[e._v("Cr√©er")])],2)},n=[],i=(a("4160"),a("caad"),a("b0c0"),a("07ac"),a("ac1f"),a("2532"),a("5319"),a("1276"),a("498a"),a("159b"),a("96cf"),a("1da1")),o=a("4360"),s=a("16b0"),c=a("4d8d"),l=a("6dc1"),u={store:o["a"],name:"Edit",mixins:[s["a"]],created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:void 0!=e.$route.query.item&&(e.item=e.$route.query.item,e.item.classe=e.CLASSES[e.item.block.type],console.log("CLASSE",e.item));case 1:case"end":return t.stop()}}),t)})))()},data:function(){return{item:{classe:{fields:[]}}}},methods:{add:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,r,n,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(console.log("add",e.$refs),e.item.thing={},a=0,r=Object.values(e.$refs);a<r.length;a++)n=r[a],i=n[0].$el,console.log(i.name,i.value),e.item.thing[i.name]=i.value;return console.log(e.item),e.item.thing.types=["http://purl.org/vocab/lifecycle/schema#Task","http://www.w3.org/ns/ldp#Resource",e.item.classe.name],e.item.thing.path=e.item.block.path,t.next=8,e.createFile(e.item.thing);case 8:o=t.sent,console.log(o),e.$router.back();case 11:case"end":return t.stop()}}),t)})))()},createFile:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,n,i,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(console.log(e),e.label=e.label.trim(),e.ttl_name=e.label.replace(/\s/g,"_"),t.activity={actor:{name:t.webId},type:"Create",summary:"",object:{name:e.label,url:"",type:"Task"}},r={},void 0!=e.url){a.next=13;break}return e.url=e.path+e.ttl_name+".ttl",a.next=9,Object(c["a"])(e.url);case 9:r=a.sent,t.activity.type="Create",a.next=17;break;case 13:return a.next=15,Object(c["c"])(e.url);case 15:r=a.sent,t.activity.type="Update";case 17:return n=r.addSubject({identifier:"this"}),i=new Date,o=i.toISOString(),void 0!=e.created?(e.modified=o,n.addLiteral(l["a"].modified,o),n.removeAll(l["e"].label),n.removeAll(l["c"].inbox),n.removeAll(l["d"].type)):(e.created=o,n.addLiteral(l["a"].created,o),n.addLiteral(l["e"].label,e.label),n.addRef(l["c"].inbox,"./"+e.ttl_name+"/inbox/"),n.addRef(l["b"].maker,t.webId),e.types.forEach((function(e){n.addRef(l["d"].type,e)}))),e.types.includes("Action")?(t.activity.object.type="Task",n.addLiteral("https://vocab.org/lifecycle/schema#state",e.status)):e.types.includes("Tension")&&(t.activity.object.type="Tension",void 0!=e.created&&(n.removeAll("https://holacratie.solidcommunity.net/public/holacratie#whatis",e.wi),n.removeAll("https://holacratie.solidcommunity.net/public/holacratie#whatshouldbe",e.wsb),n.removeAll("http://www.w3.org/ns/org#memberOf"),n.removeAll("http://www.w3.org/ns/org#purpose")),n.addLiteral("https://holacratie.solidcommunity.net/public/holacratie#whatis",e.wi),n.addLiteral("https://holacratie.solidcommunity.net/public/holacratie#whatshouldbe",e.wsb),void 0!=e.roles&&(e.roles.split(",").forEach((function(e){n.addLiteral("http://www.w3.org/ns/org#memberOf",e.trim())})),console.log("TODO: must look at existing groups & existing frineds groups & activity published groups")),void 0!=e.domains&&(e.domains.split(",").forEach((function(e){n.addLiteral("http://www.w3.org/ns/org#purpose",e.trim())})),console.log("TODO: must look at https://www.wikidata.org/w/api.php?action=wbsearchentities&language=fr&format=json&search=Ecology"))),a.next=24,r.save();case 24:return console.log("data saved",e.label),console.log(t.activity),a.abrupt("return",e);case 27:case"end":return a.stop()}}),a)})))()}}},d=u,m=(a("d572"),a("2877")),p=Object(m["a"])(d,r,n,!1,null,null,null);t["default"]=p.exports},"16b0":function(e,t,a){"use strict";a("a15b"),a("baa5"),a("ac1f"),a("8a79"),a("5319"),a("498a"),a("96cf");var r=a("1da1"),n=a("00e8"),i=a.n(n),o=a("7fed"),s=a.n(o),c=window.solid,l=new s.a(i.a),u=a("9b92"),d=u.namedNode;t["a"]={created:function(){this.webId=this.$store.state.webId,this.storage=this.$store.state.storage},methods:{getStorage:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var r,n,i,o,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.endsWith("#we")||e.endsWith("#this")?e:e+"#we",a.next=3,c.data[r].storage;case 3:if(n=a.sent,void 0!="".concat(n)){a.next=21;break}return i=t.url.substring(0,t.url.lastIndexOf("/")),a.next=8,c.data[r].vcard$fn;case 8:return o=a.sent,s="".concat(o).trim().replace(/\s/g,"_"),n=[i,s,""].join("/"),a.next=13,!l.itemExists(t.storage);case 13:if(!a.sent){a.next=18;break}return a.next=16,l.createFolder(t.storage);case 16:a.next=19;break;case 18:case 19:return a.next=21,c.data[r]["http://www.w3.org/ns/pim/space#storage"].set(d(n));case 21:return a.abrupt("return","".concat(n));case 22:case"end":return a.stop()}}),a)})))()}},computed:{webId:{get:function(){return this.$store.state.webId},set:function(){}},storage:{get:function(){return this.$store.state.storage},set:function(){}}}}},d572:function(e,t,a){"use strict";a("fea3")},fea3:function(e,t,a){}}]);
//# sourceMappingURL=edit.bb4402a8.js.map