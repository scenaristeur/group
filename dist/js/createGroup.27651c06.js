(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["createGroup"],{"16b0":function(e,t,r){"use strict";r("a15b"),r("baa5"),r("ac1f"),r("8a79"),r("5319"),r("498a"),r("96cf");var a=r("1da1"),n=r("00e8"),s=r.n(n),o=r("7fed"),u=r.n(o),i=window.solid,c=new u.a(s.a),p=r("9b92"),d=p.namedNode;t["a"]={created:function(){this.webId=this.$store.state.webId,this.storage=this.$store.state.storage},methods:{getStorage:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var a,n,s,o,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.endsWith("#we")||e.endsWith("#this")?e:e+"#we",r.next=3,i.data[a].storage;case 3:if(n=r.sent,void 0!="".concat(n)){r.next=21;break}return s=t.url.substring(0,t.url.lastIndexOf("/")),r.next=8,i.data[a].vcard$fn;case 8:return o=r.sent,u="".concat(o).trim().replace(/\s/g,"_"),n=[s,u,""].join("/"),r.next=13,!c.itemExists(t.storage);case 13:if(!r.sent){r.next=18;break}return r.next=16,c.createFolder(t.storage);case 16:r.next=19;break;case 18:case 19:return r.next=21,i.data[a]["http://www.w3.org/ns/pim/space#storage"].set(d(n));case 21:return r.abrupt("return","".concat(n));case 22:case"end":return r.stop()}}),r)})))()}},computed:{webId:{get:function(){return this.$store.state.webId},set:function(){}},storage:{get:function(){return this.$store.state.storage},set:function(){}}}}},4585:function(e,t,r){"use strict";r("b0c0"),r("ac1f"),r("8a79"),r("5319"),r("96cf");var a=r("1da1"),n=r("4d8d"),s=r("6dc1"),o=r("00e8"),u=r.n(o),i=r("7fed"),c=r.n(i),p=window.solid,d=new c.a(u.a);t["a"]={methods:{createGroup:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var a,o,u,i,c,p,l,g;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return console.log("todo formate a good url without single quotes..."),e.encoded_name=e.name.replace(/\s/g,"_").replace(/'/g,"_").replace(/"/g,"_"),e.path=e.path.endsWith("/")?e.path:e.path+"/",a=new Date,o=a.toISOString(),e.url=e.path+e.encoded_name+".ttl",e.identifier="we",e.maker=t.webId,e.inbox="./"+e.encoded_name+"/inbox/",e.storage="./"+e.encoded_name+"/",r.next=12,Object(n["a"])(e.url);case 12:return u=r.sent,i=u.addSubject({identifier:e.identifier}),i.addLiteral(s["g"].fn,e.name),i.addRef(s["c"].inbox,e.inbox),i.addRef(s["f"].storage,e.storage),i.addLiteral(s["a"].created,o),i.addRef(s["b"].maker,e.maker),i.addRef(s["g"].hasMember,e.maker),i.addRef(s["d"].type,s["g"].Group),void 0!=e.purpose&&i.addLiteral("http://www.w3.org/ns/org#purpose",e.purpose),void 0!=e.super&&i.addRef("http://www.w3.org/ns/org#subOrganizationOf",e.super),console.log("GROUP",e),r.prev=24,r.next=27,u.save();case 27:return e.creation={status:"ok",message:"group created"},r.next=30,d.createFolder(e.path+e.encoded_name+"/inbox/Invitations/");case 30:return r.next=32,d.createFolder(e.path+e.encoded_name+"/inbox/Requetes/");case 32:return r.next=34,d.createFolder(e.path+e.encoded_name+"/inbox/Traites/");case 34:return r.next=36,d.createFolder(e.path+e.encoded_name+"/inbox/Corbeille/");case 36:console.log("ok"),r.next=44;break;case 39:r.prev=39,r.t0=r["catch"](24),console.log(r.t0),alert(r.t0),e.creation={status:"error",message:r.t0};case 44:return r.next=46,Object(n["c"])(e.maker);case 46:return c=r.sent,p=c.getSubject(e.maker),p.addRef("http://www.w3.org/ns/org#memberOf",e.url+"#"+e.identifier),r.prev=49,r.next=52,c.save();case 52:r.next=58;break;case 54:r.prev=54,r.t1=r["catch"](49),alert(r.t1),console.log(r.t1);case 58:if(void 0==e.super){r.next=73;break}return r.next=61,Object(n["c"])(e.super);case 61:return l=r.sent,g=l.getSubject(e.super),g.addRef("http://www.w3.org/ns/org#hasSubOrganization",e.url+"#"+e.identifier),r.prev=64,r.next=67,l.save();case 67:r.next=73;break;case 69:r.prev=69,r.t2=r["catch"](64),alert(r.t2),console.log(r.t2);case 73:return r.abrupt("return",e);case 74:case"end":return r.stop()}}),r,null,[[24,39],[49,54],[64,69]])})))()},getGroupStorage:function(e){return Object(a["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,p.data[e]["http://www.w3.org/ns/pim/space#storage"];case 2:return r=t.sent,a={folders:[],files:[]},t.next=6,d.itemExists("".concat(r));case 6:if(!t.sent){t.next=12;break}return t.next=9,d.readFolder("".concat(r));case 9:a=t.sent,t.next=14;break;case 12:return t.next=14,d.createFolder("".concat(r));case 14:return t.abrupt("return",a);case 15:case"end":return t.stop()}}),t)})))()}}}},f9c1:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container fluid"},[r("h3",[e._v("Nouveau GRoup")]),null!=e.webId?r("div",[r("b-form-input",{ref:"name",staticClass:"m-3",attrs:{placeholder:"Nom du groupe"},model:{value:e.group.name,callback:function(t){e.$set(e.group,"name",t)},expression:"group.name"}}),r("b-form-textarea",{staticClass:"m-3",attrs:{placeholder:"Raison d'être"},model:{value:e.group.purpose,callback:function(t){e.$set(e.group,"purpose",t)},expression:"group.purpose"}}),r("b-form-input",{staticClass:"m-3",attrs:{placeholder:"Super groupe"},model:{value:e.group.super,callback:function(t){e.$set(e.group,"super",t)},expression:"group.super"}}),r("b-form-select",{staticClass:"m-3",attrs:{options:e.privacy_options},model:{value:e.group.privacy,callback:function(t){e.$set(e.group,"privacy",t)},expression:"group.privacy"}}),r("b-form-input",{staticClass:"m-3",attrs:{placeholder:"Chemin"},model:{value:e.path,callback:function(t){e.path=t},expression:"path"}}),r("b-button",{attrs:{variant:"primary"},on:{click:e.create}},[e._v("Créer")]),r("br"),r("small",[e._v(" "+e._s(e.group)+" "+e._s(e.group_url)+" ")])],1):r("b-alert",{attrs:{variant:"info",show:""}},[e._v("Please login with a Solid webId to create a group !")])],1)},n=[],s=(r("b0c0"),r("96cf"),r("1da1")),o=r("4585"),u=r("16b0"),i={name:"CreateGroup",mixins:[o["a"],u["a"]],mounted:function(){void 0!=this.$refs.name&&this.$refs.name.focus()},data:function(){return{group:{privacy:"public"},privacy_options:[{value:"public",text:"Public. Tout le monde peut voir qui est dans le groupe et ce qui est publié"},{value:"private",text:"Privé. Seuls les membres peuvent voir qui est dans le groupe et ce qui est publié"}],group_url:null}},created:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.update();case 1:case"end":return t.stop()}}),t)})))()},methods:{setSuperAndPath:function(e,t){var r=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(void 0==e){a.next=8;break}return r.group.super=void 0!=t?e+t:e,a.next=4,r.getGroupStorage(r.group.super);case 4:n=a.sent,r.path="".concat(n.url),a.next=9;break;case 8:r.path=r.$store.state.storage+r.group.privacy+"/";case 9:case"end":return a.stop()}}),a)})))()},create:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.group.path=e.path,t.next=3,e.createGroup(e.group);case 3:r=t.sent,e.group_url=r.url,"ok"==r.creation.status&&e.$router.push("group?url="+r.url+"#"+r.identifier);case 6:case"end":return t.stop()}}),t)})))()},update:function(){void 0!=this.$route.query.url?this.setSuperAndPath(this.$route.query.url,this.$route.hash):this.path=this.storage+this.group.privacy+"/",void 0!=this.$refs.name&&this.$refs.name.focus()}},watch:{url:function(){this.group.super=this.url},$route:function(e){this.setSuperAndPath(e.query.url,e.hash)},storage:function(){this.update()},group:function(){this.update()}},computed:{url:{get:function(){return void 0!=this.$route.hash?this.$route.query.url+this.$route.hash:this.$route.query.url},set:function(){}},path:{get:function(){return this.storage+this.group.privacy+"/"},set:function(){}}}},c=i,p=r("2877"),d=Object(p["a"])(c,a,n,!1,null,null,null);t["default"]=d.exports}}]);
//# sourceMappingURL=createGroup.27651c06.js.map